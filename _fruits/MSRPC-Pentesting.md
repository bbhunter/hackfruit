---
title: Microsoft Remote Procedure Call (MSRPC) Pentesting
desc: Default port is 135, 593.
tags: [135, 593, Nmap, RPC, Windows]
alts: []
render_with_liquid: false
---

## 1. Enumeration

1. **Use Nmap**

    ```sh
    nmap --script msrpc-enum -p 135 <target-ip>
    ```

2. **Use Impacket**

    ```sh
    impacket-rpcdump -port 135 <target-ip>
    ```

<br />

## 2. Investigation

```sh
rpcinfo -p

# NFS only
rpcinfo -p | grep nfs
```

<br />

## 3. Connect

1. **Use Rpcclient**

    ```sh
    rpcclient <target-ip>

    # Specify username (-W: workgroup, -N: no pass)
    rpcclient -U username <target-ip>
    rpcclient -W WORKGROUP -U username <target-ip>
    rpcclient -U username -N <target-ip>

    # Kerberos
    rpcclient -k <target-ip>
    ```

    - **Basic Commands**

        ```sh
        # Server info
        rpcclient $> srvinfo

        # Enumerate domains
        rpcclient $> enumdomains
        # Enumerate domain users
        rpcclient $> enumdomusers
        # Enumerate domain groups
        rpcclient $> enumdomgroups

        # Domain info
        rpcclient $> querydominfo

        # Current username
        rpcclient $> getusername
        ```