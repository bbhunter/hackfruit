---
title: Microsoft Remote Procedure Call (MSRPC) Pentesting
desc:  It is also known as a function call or a subroutine call. Default port is 135, 593.
tags: [135, 593, Nmap, RPC, Windows]
alts: []
render_with_liquid: false
---

## Enumeration

- **Nmap**

    ```sh
    nmap --script msrpc-enum -p 135 <target-ip>
    ```

- **Impacket**

    ```sh
    impacket-rpcdump -port 135 <target-ip>
    ```

- **Metasploit**

    ```sh
    use auxiliary/scanner/dcerpc/endpoint_mapper
    use auxiliary/scanner/dcerpc/hidden
    use auxiliary/scanner/dcerpc/management
    use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor
    ```

<br />

## Investigation

**rpcinfo** reports RPC information. If you don’t have it, install ‘rpcbind’ first to use the rpcinfo.

```sh
sudo apt install rpcbind
```

Run the following command.

```sh
rpcinfo -p <target-ip>

# NFS only
rpcinfo -p <target-ip> | grep nfs
```

<br />

## Connect

- **Rpcclient**

    ```sh
    rpcclient <target-ip>

    # Specify username (-W: workgroup, -N: no pass)
    rpcclient -U username <target-ip>
    rpcclient -W WORKGROUP -U username <target-ip>
    rpcclient -U username -N <target-ip>

    # Kerberos
    rpcclient -k <target-ip>
    ```

    - **Basic Commands**

        ```sh
        # Server info
        rpcclient $> srvinfo

        # Enumerate domains
        rpcclient $> enumdomains
        # Enumerate domain users
        rpcclient $> enumdomusers
        # Enumerate domain groups
        rpcclient $> enumdomgroups

        # Domain info
        rpcclient $> querydominfo

        # Current username
        rpcclient $> getusername
        ```