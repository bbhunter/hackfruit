---
title: Lightweight Directory Access Protocol (LDAP) Pentesting
desc: Default port is 389 (LDAP), 636 (LDAPS).
tags: [389, Active Directory, LDAP, Windows]
alts: []
render_with_liquid: false
---

## 1. Enumeration

1. **Use Nmap**

    ```sh
    nmap --script ldap-brute --script-args ldap.base='"cn=users,dc=cqure,dc=net"' -p 389 <target-ip>
    nmap --script ldap-search -p 389 <target-ip>
    nmap --script ldap-* -p 389 <target-ip>
    nmap --script "ldap* and not brute" -p 389 <target-ip>
    ```

<br />

## 2. Search LDAP

```sh
ldapsearch -x -H ldap://10.0.0.1 -b "dc=example,dc=com"

# As administrator
ldapsearch -x -H ldap://10.0.0.1 -b "dc=example,dc=com" -D "cn=admin,dc=example,dc=com" -w password
ldapsearch -x -H ldap://10.0.0.1 -b "dc=example,dc=com" -D "cn=admin,dc=example,dc=com" -W
```

<br />

## 3. Dump the Active Directory Information

If you have the credential, you can get the Active Directory information via LDAP.

```sh
ldapdomaindump -u username -p password 10.0.0.1
```

<br />

## 4. Connect to Active Directory Certificate Services (AD CS)

```sh
crackmapexec ldap 'domaincontroller' -d 'domain' -u 'user' -p 'password' -M adcs
```