---
title: Web Basic Pentesting
desc: HTTP uses a default port 80. HTTPS uses a default port 443.
tags: [80, 443, HTTP, Nikto, Nmap, OpenSSL, Web]
alts: [Web-Content-Discovery]
render_with_liquid: false
---

## Enumeration

1. **Automation**

    1. **Use Nmap**

        ```sh
        nmap --script http-auth --script-args http-auth.path=/login -p 80,443 <target-ip>
        nmap --script http-devframework -p 80,443 <target-ip>
        nmap --script http-enum -p 80,443 <target-ip>
        nmap --script http-headers -p 80,443 <target-ip>
        nmap --script http-methods -p 80,443 <target-ip>
        ```

    2. **Use Nikto**

        **Nikto** is a web server scanenr.

        ```sh
        nikto -h http://<target-ip>
        ```

    3. **Use Whatweb**

        **[Whatweb](https://github.com/urbanadventurer/WhatWeb){:target="_blank"}** is a web scanner.

        ```sh
        whatweb <target-ip>

        # Aggression level (1-4)
        whatweb -a 3 <target-ip>
        ```

        - **Plugins**

            ```sh
            # List all plugins
            whatweb -l

            # Search plugins
            whatweb -I apache
            whatweb -I phpBB
            whatweb -I phpmyadmin
            whatweb -I windows

            # Use plugin
            whatweb -p phpBB <target-ip>
            ```

    3. **Subdomain Enumeration**

        1. **Use Sublist3r**

            **[Sublist3r](https://github.com/aboul3la/Sublist3r){:target="_blank"}** is fast subdomains enumeration tool.

<br />

## Investigation

1. **Comprehensive Tools**

    - **[httpx](https://github.com/projectdiscovery/httpx){:target="_blank"}**

        Multi purpose HTTP toolkit.

2. **Programs**

    1. **WHOIS**

        ```sh
        whois example.com
        ```

    1. **SSL/TLS Connection**

        1. **Use OpenSSL**

            ```sh
            openssl s_client --connect example.com:443
            ```

        2. **Use sslscan**

            ```sh
            sslscan example.com
            ```

<br />

## Python Request

1. **GET**

    ```python
    #!/usr/bin/env python3
    import requests

    ip = '10.0.0.1'
    port '80'
    url = 'http://%s:%s' % (ip, port)
    ua = 'Mozilla/5.0 ...'

    # Args
    params = {'page': '2', 'item': 'chair'}
    headers = {'User-Agent': ua}
    cookies = {'PHPSESSID': 'a953b5...'}
    auth = requests.auth.HTTPBasicAuth('username', 'password')

    r = requests.get(url, params=params, headers=headers, cookies=cookies, auth=auth)

    print(r.text)
    ```

    - **Use Session**

        ```python
        #!/usr/bin/env python3
        import requests

        url = 'http://example.com'

        session = requests.Session()
        r = session.get(url)

        print(r.text)
        ```

2. **POST**

    ```python
    #!/usr/bin/env python3
    import requests

    url = 'http://example.com/login'

    data = {'username': 'admin', 'password': 'admin'}

    # Args
    headers = {'User-Agent': ua}
    cookies = {'PHPSESSID': 'a953b5...'}

    r = requests.post(url, data=data, headers=headers, cookies=cookies)
    ```

    - **Use Session**

        ```python
        #!/usr/bin/env python3
        import requests

        url = 'http://example.com/comment'

        data = {'name': 'Mike', 'comment': 'Hello'}

        session = requests.Session()

        r = session.post(url, data=data)

        print(r.text)
        ```