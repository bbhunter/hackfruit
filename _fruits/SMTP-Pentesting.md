---
title: Simple Mail Transfer Protocol (SMTP) Pentesting
desc: Default port 25 (SMTP), 465 (SMTPS), 587 (SMTPS).
tags: [25, 465, 587, Netcat, Nmap, SMTP]
alts: []
render_with_liquid: false
---

## Enumeration

1. **Using Nmap**

    ```sh
    nmap --script smtp-brute -p 25,465,587 <target-ip>
    nmap --script smtp-commands -p 25,465,587 <target-ip>
    nmap --script smtp-enum-users -p 25,465,587 <target-ip>
    nmap --script smtp-ntlm-info --script-args smtp-ntlm-info.domain=example.com -p 25,465,587 <target-ip>
    nmap --script smtp-vuln-cve2011-1764 -p 25,465,587 <target-ip>
    nmap --script smtp-* -p 25,465,587 <target-ip>
    ```

<br />

## Investigation

1. **Banner Grabbing**

    ```sh
    nc -vn <target-ip> 25
    ```

<br />

## Connect

1. **SMTPS**

    ```sh
    # Port 465
    openssl s_client -crlf -connect <target-ip>:465
    # Port 587
    openssl s_client -starttls smtp -crlf -connect <target-ip>:587
    ```
